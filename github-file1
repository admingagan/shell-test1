added from github
fixed some bug
